version: 2

models:
  - name: dim_customers
    description: >
      Customer dimension table providing one row per customer with
      derived lifetime and engagement metrics based on order history.

    columns:
      - name: customer_id
        description: "Unique identifier for a customer"
        tests:
          - not_null
          - unique

      - name: country
        description: "Country associated with the customer"

      - name: total_orders
        description: "Total number of orders placed by the customer"

      - name: first_order_date
        description: "Date of the customer's first recorded order"

      - name: last_order_date
        description: "Date of the customer's most recent order"

      - name: lifetime_value
        description: "Total revenue generated by the customer across all orders"
  - name: fct_orders
    description: >
      Order fact table at order grain. This model represents the canonical
      transactional record for revenue and order-level analytics and is the
      source for derived metrics such as Average Order Value (AOV).

    columns:
      - name: order_id
        description: "Unique identifier for an order"
        tests:
          - not_null
          - unique

      - name: customer_id
        description: "Customer who placed the order"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('dim_customers')
                field: customer_id

      - name: order_date
        description: "Date on which the order was placed"
        tests:
          - not_null

      - name: total_amount
        description: "Total monetary value of the order"
        tests:
          - not_null

      - name: total_items
        description: "Total quantity of items included in the order"
  - name: fct_order_items_enriched
    description: >
      Order item fact table enriched with order, customer, and product attributes.
      This model joins all four source tables and provides line-item level revenue
      metrics for detailed analytics.

    columns:
      - name: order_item_id
        description: "Unique identifier for an order item"
        tests:
          - not_null
          - unique

      - name: order_id
        description: "Order associated with the order item"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('fct_orders')
                field: order_id

      - name: customer_id
        description: "Customer who placed the order"
        tests:
          - not_null
          - relationships:
              arguments:
                to: ref('dim_customers')
                field: customer_id

      - name: product_id
        description: "Product included in the order item"
        tests:
          - not_null

      - name: quantity
        description: "Number of units purchased for the product"
        tests:
          - not_null

      - name: unit_price
        description: "Price per unit of the product"
        tests:
          - not_null

      - name: item_revenue
        description: "Revenue generated by the order item (quantity Ã— unit_price)"

